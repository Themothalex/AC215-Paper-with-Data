The dangers of conditioning on the time of occurrence of one demographic process in the analysis of another
Jan M. Hoem
Stockholm University

In studies of the fertility of migrants in which the data are confined to the migrants only, estimation bias will normally appear in comparisons of childbearing before and after migration. The same issue arises in studies of union formation before and after first birth, marriage formation before and after home purchase, and in any other comparison of behavior before and after an index event if one confines the study only to those who have experienced the index event. It is normally better to avoid analysis of behavior before the index event because such analysis actually conditions on the later arrival of the index event. In this paper, we provide graphical and mathematical representations of this problem and show how one can get a meaningful (unconditional) comparison of behavior before and after the index event provided the data contain enough information for both sub-periods. Otherwise, the analyst should refrain from making a comparison of this nature.

Keywords: parallel processes; migration and childbearing; marriage formation and childbearing; marriage formation and home purchase; marriage formation and criminal behavior; estimation bias produced by conditioning; observational design in event-history analysis

Introduction
Demographers often study individual-level processes that develop in parallel and in interaction with each other. These pairs of interacting processes include migration and childbearing, marriage formation and childbearing, union formation and criminal behavior, and marriage formation and home purchase; one can easily think of many more examples. In this paper, we address the analytic danger involved in comparing fertility before and after geographic migration, marriage formation before and after entry into motherhood, and marriage formation before and after the purchase of a home. We also indicate how similar issues arise if the avoidance of criminal behavior is studied in life phases before and after changes in family union status. Conditional before-and-after analyses of this kind can be problematic, for there is a fundamental asymmetry between the analysis for the time before and the analysis for the time after the occurrence of an index event when data are confined to those who experience that event. 

Here we use the connection between migration and entry into motherhood as our main vehicle of presentation, and show that the analysis of first childbearing shortly before an observed case of migration will underestimate the fertility of childless migrants in the sending population if the presence of a child hampers out-migration, while in contrast, an assessment of the corresponding rate after migration correctly estimates the fertility of in-migrants in the receiving population (unless some other factor interferes). The intensity estimate for the time before the index event turns out to be biased downwards in this case, but in other cases, the bias is the reverse. For instance, the estimated rate of marriage formation shortly before a home purchase will be biased upward if only homebuyers are considered and if the home-purchase intensity is higher after marriage formation than before it. Only if the transition rates on the second behavior (migration, say) are the same before and after the behavior in focus (childbearing) can one be sure in general that there will be no such bias. Unfortunately, one can rarely know or demonstrate whether a correspondence of this nature is present in the data.

To handle general issues of this kind, we employ a device that is now standard in several disciplines, and that represents individual behavior as transitions between discrete states in a time-continuous Markov chain, such as the transition from childlessness to motherhood. We have already used the term ‘intensity’ for a theoretical rate of transition between two such states and thus have a brief and neutral term to denote what in the general theory of event-history analysis is often called the ‘instantaneous transition rate’ (a cumbersome term) or ‘hazard’ or ‘risk’ (which sounds threatening).

Studying the connection between behavior (such as childbearing) before and after an event on a different process (such as migration) involves conditioning on a time of occurrence on the second process. With such conditioning, time is centered on the index event (the geographical move), and the intensity of the other kind of event (childbearing) is estimated for times before and after the index event. Times of occurrence may be counted formally as negative when they occur before the index event and positive when they appear after it, with the time of occurrence of the index event as the origin (zero point) for a conditional pre-and-post-event analysis.

The specific question we address is how the comparison of childbearing intensities before and after migration, using individual-level data confined to in-migrants, can produce a bias, and what the bias is. The purpose of the paper is to warn against pitfalls involved in analyses of this nature and to note that the possible presence of plans or intentions does not in itself remove biases produced by the conditioning. Of course, planning ahead is part of human nature, but in the absence of reliable individual-level information about intentions, the analyst cannot distinguish between estimation biases and real behavior. We show that one cannot safely disregard the biases in such circumstances as the following: people abstain from childbearing because they plan to migrate; they buy a home because they intend to marry; they marry because they intend to have children; or they change their criminal behavior because they intend to marry. Correspondingly, the intention to have a child after migration does not remove bias in the fertility estimate for periods before migration.

Our paper contributes to the already rich literature on observational design in event-history analysis; see, for instance, Aalen et al. (1980), Courgeau and Lelièvre (1992, Chapters 5–6), Andersen et al. (1993), Blossfeld and Rohwer (2002, Chapter 6), and just recently Keiding (2013). In this tradition, Hoem and Kreyenfeld (2006) may be among the authors who have rejected most explicitly the practice of conditional pre-and-post-event analysis even if one makes assumptions about unmeasured plans and intentions. Here we spell out our reasons in a novel manner and illuminate them with further examples. We add to the design literature by warning against the dangers of conditioning on one behavior in the analysis of another. We are not aware that anyone has addressed these issues in any generality before.
We have organized our paper as follows. In Section 2 we use a graphical representation to illuminate the issues we address. In Section 3 we use a collection of concrete situations to describe analytical problems that are likely to appear in a conditional before-and-after analysis. A mathematical representation is presented in Section 4, and Section 5 is a summary of our conclusions.
To handle general issues of this kind, we employ a device that is now standard in several disciplines, and that represents individual behaviour as transitions between discrete states in a time-continuous Markov chain, such as the transition from childlessness to motherhood. We have already used the term ‘intensity’ for a theoretical rate of transition between two such states and thus have a brief and neutral term to denote what in the general theory of event-history analysis is often called the ‘instantaneous transition rate’ (a cumbersome term) or ‘hazard’ or ‘risk’ (which sounds threatening).

Studying the connection between behaviour (such as childbearing) before and after an event on a different process (such as migration) involves conditioning on a time of occurrence on the second process. With such conditioning, time is centred on the index event (the geographical move), and the intensity of the other kind of event (childbearing) is estimated for times before and after the index event. Times of occurrence may be counted formally as negative when they occur before the index event and positive when they appear after it, with the time of occurrence of the index event as the origin (zero point) for a conditional pre-and-post-event analysis. Anticipating a later generalization, we shall call the behaviour to be analysed ‘Process A’ (childbearing) and use the term ‘Process B’ for the behaviour on which one conditions (migration). The two processes play asymmetric roles in the statistical theory. 

The specific question we address is how the comparison of childbearing intensities before and after migration, using individual-level data confined to in-migrants, can produce a bias, and what the bias is. The purpose of the paper is to warn against pitfalls involved in analyses of this nature and to note that the possible presence of plans or intentions does not in itself remove biases produced by the conditioning. Planning ahead is part of human nature, but in the absence of reliable individual-level information about intentions, the analyst cannot distinguish between estimation biases and real behaviour. We show that one cannot safely disregard the biases in such circumstances as the following: people abstain from childbearing because they plan to migrate; they buy a home because they intend to marry; they marry because they intend to have children; or they change their criminal behaviour because they intend to marry. Correspondingly, the intention to have a child after migration does not remove bias in the fertility estimate for periods before migration.

Our paper contributes to the already rich literature on observational design in event-history analysis; see, for instance, Aalen et al. (1980), Courgeau and Lelièvre (1992, Chapters 5–6), Andersen et al. (1993), Blossfeld and Rohwer (2002, Chapter 6), and just recently Keiding (2013). In this tradition, Hoem and Kreyenfeld (2006) may be among the authors who have rejected most explicitly the practice of conditional pre-and-post-event analysis even if one makes assumptions about unmeasured plans and intentions. Here we spell out our reasons in a novel manner and illuminate them with further examples. We add to the design literature by warning against the dangers of conditioning on one behaviour in the analysis of another. We are not aware that anyone has addressed these issues in any generality before. 

We have organized our paper as follows. In Section 2, we use a graphical representation to illuminate the issues we address. In Section 3, we use a collection of concrete situations to describe analytical problems that are likely to appear in a conditional before-and-after analysis. A mathematical representation is presented in Section 4, and Section 5 is a summary of our conclusions.
All individuals are subject to the same set of intensities, which is a simplification. We will consider various alternative specifications as we progress in our account. Before we address that, however, we note that issues of the same kind arise whenever two interacting demographic behaviors or processes are studied in a conditional before-and-after schema. Section 3 contains a number of illuminating illustrations, which we have already mentioned in our introduction.

Issues of the same nature arise in any setting where interacting behaviors are studied.

**3. Illuminating examples**

**3.1. Marriage and first birth**
Replicating a pattern noted in conditional before-and-after studies, Hoem and Kreyenfeld (2006) showed that conditioning on the time of first birth produces a cusp in marriage intensity around the time of first birth in their German data. However, this is an artifact of the method of analysis, and it disappears, and other patterns appear when childbearing (taken as Process B in our general theory) and marriage formation (Process A) are studied as two interacting processes, each in its own right. Conditioning on one process (B) and studying the other behavior (A), conditional on the first, corresponds to taking Process B to be the cause of Process A in a situation where both processes are probably jointly determined by other features not observed by the analyst, such as the decision process of the individual or the couple. We regard it as better practice, therefore, to study A and B together rather than to condition on one of them and run the risk of distortion.

**3.2. The disruption of childbearing by migration**
In the case of migrant fertility, some of the main existing theories revolve around issues of fertility 'disruption'. The fertility disruption hypothesis refers to a temporary discontinuity in childbearing among migrants that has no counterpart for non-migrants. This hypothesis holds that childbearing is likely to be postponed or possibly forgone among migrants in the period just before migration, during the migration process itself, and for some time following migration due to reasons like spousal separation or couples deciding to postpone childbearing while they prepare for migration, settle into the destination society, and find basic housing and employment. This theory further suggests that following temporary fertility disruption, at least some of the postponed fertility may be made up during a period of fertility catch-up. If the purpose of a study is to test the disruption hypothesis, the focus is the fertility of migrants, not the fertility of those who could have migrated but did not. If it is found that the recorded fertility of people who actually migrate is lowered during the period approaching migration and shortly after it, but rebounds some time later, these analysts would see this pattern as consistent with the predictions of the disruption hypothesis.

**3.3. Union formation and home purchase - Intentionality**
The literature contains some contributions that advocate the inclusion of (unobserved) plans and intentions, at least for descriptive purposes, which fits with an argument about intentional behavior in house purchasing and in marriage formation. If intentionality is stressed, the post-purchase marriage intensity appears larger than the pre-purchase intensity, and the purchase intensity larger after than before marriage formation. This fits with an argument about intentional behavior in house purchasing and in marriage formation. However, conditioning pre-and-post-event tends to overestimate when the actual sequence of the two processes may depend largely on chance, such as the housing market situation being purely accidental.

**3.4. Family dynamics and criminal activity**
Similar issues appear in studies of connections observed between family dynamics and criminal activity. The theory suggests that the criminally inclined reduce their criminal activity to marry or gain a partner and that practicalities of their lives change in favor of fewer offenses once a partner has been found. Observing that the lower offending rates of married people develop over the years before marriage rather than as a consequence of the marriage act, suggestive that the features of the process are not simply binary but spread over periods of courtship and engagement to be married. Analytical challenges are similar to those in other examples where conditioning on one event diverges from another, potentially obscuring genuine behavioral links with biases introduced by methodological frameworks. 

**4. General theory**
We now turn to the mathematics that covers much of our reasoning. Moving forward, additional generalizations will be required to cover aspects such as those discussed in Section 3.4. We define scenarios and probabilities relating transitions between various states, aiming to account for both observed and unobserved factors affecting the dynamics of interactions and transitions among specified demographic behaviors or processes.
Procedure described in this paper (Sections 2 and 4). A generalization of our mathematics is needed to cover a richer description of union dynamics and to account for multiple occurrences of the criminal event. Compare Figure 6.2 in the book by Courgeau and Lelièvre (1992). In fact, taking consensual unions explicitly into account may in itself catch much of the effect that Laub et al. (1998) postulate, though conditioning on the formation of a consensual union creates problems of the same kind as those created by conditioning on a marital union; the problems are caused by the conditioning, not by the type of union. The same issues arise for studies of other connections between family dynamics and criminal behaviour. For example, they appear in a study by Cassan et al. (2000), who find that union dissolution is more frequent during the months preceding imprisonment. Fortunately, at least they carefully refrain from offering any causal interpretation of their findings; in fact, they do not advocate any conclusion as to whether union dissolution increases the probability of committing an offence or whether criminal activity itself is the common cause of both disruption and imprisonment. This is our interpretation of Laurent Toulemon’s translation from the French original in a private communication.

We now turn to the mathematics that will cover much of our reasoning (although some further generalization will be required to cover such items as those of Section 3.4). For our general argument we let A and B be any two interacting concurrent processes on the individual level. In a Markov-chain formulation the intensities are α0(t) for the A-transition where the event A occurs at a time when B has not occurred, α1(t) for the occurrence of A after B, β0(t) for the occurrence of B at a time when A has not occurred, and β1(t) for the occurrence of B after A has occurred. When the four statuses are numbered from 0 to 3 as indicated in Figure 1, α0(t) is the intensity for the transition from State 0 to 1 at process time t, α1(t) is the intensity for the transition from State 2 to 3 at process time t, β0(t) is the intensity for the transition from State 0 to 2 at process time t, and β1(t) is the corresponding intensity for the transition from State 1 to 3, as indicated in the figure. A proper before-and-after analysis of the A process consists in comparing (an estimate of) α0(t) with (an estimate of) α1(t).

To pick up the effect of conditioning on an occurrence of Process B in the analysis of Process A, we define a conditional intensity rA(s | t) by the relation. Then rA(s | t), or an approximation to it, is what is estimated by the computations on the positive and negative time axis, as described above, depending on whether s > t or s < t. To correspond with the positive and negative times, we now treat the cases t < s and t > s separately, as follows. 

First, consider positive occurrence times (s > t). The transitions in Figure 1 that are involved in the numerator in the long fraction above, correspond to the following scenario: Stay in State 0 up to time t, then move to state 2 in the interval t,t + dt), and subsequently stay in State 2 through time s. The corresponding probability is p00(0,t)β0(t)dt p22(t,s), where in each instance pij (x, y) is the probability of moving to State j by time y for someone who is in State i at time x. This gives us an expression for the numerator. A corresponding expression for the denominator consists of the elements in the first row of the scenario, followed by a transition from State 2 to State 3 in the interval (s, s + ds). Therefore, the denominator is p00(0,t)β0(t)dt p22(t,s)α1(s)ds. Dividing out factors common to the numerator and denominator thus gives rA(s | t) = α1(s) when s > t. This shows that the estimand of the procedure used after the index time of occurrence of an event on Process B is the post-B transition intensity for the event A. This mirrors general results for all kinds of counting processes and is normally taken for granted without further reflection. In the migration and childbearing situation it means that, at least as far as the analysis of fertility after in-migration is concerned, it can be carried out with no specific danger of estimation bias, a fact that has been exploited by Andersson (2004), Andersson and Scott (2005), Kulu and Vikat (2007), Kulu and Milewski (2007), Milewski (2008), and innumerable others.

Next, consider the situation when s < t (corresponding to negative occurrence times). Then the transitions from Figure 1 that correspond to the numerator are as follows: Stay in State 0 until time s and then follow one of the following disjoint alternatives: either (i) also stay on in State 0 until time t and then move to State 2 before time t + dt, or (ii) move to State 1 by time t and then move from State 1 to State 3 before time t + dt. The probability of such a scenario is p00(0,s)[p00(s,t)β0(t)dt + p01(s,t)β1(t)dt]. The transitions involved in the denominator are as follows: Stay in State 0 until time s, then move to State 1 by time s + ds, then stay there until time t, and subsequently move to State 3 by time t + dt. The corresponding probability is p00(0,s)α0(s)ds p11(s,t)β1(t)dt. When we combine the latter two formulas and remove factors that cancel, we get rA(s | t) = p11(s,t)β1(t) / (p00(s,t)β0(t) + p01(s,t)β1(t)) α0(s). Therefore, estimating the transition rate for Process A for times before the index occurrence of event B does not provide an unbiased estimator of the pre-B transition rate α0(s) of A, except in special cases (to which we return below). Instead, we get the correct transition rate α0(s) multiplied by a distortion factor uA(s,t) = p11(s,t)β1(t) / (p00(s,t)β0(t) + p01(s,t)β1(t)). For values of s < t close to the time t of occurrence of B, the distortion factor is close to lim s→t uA(s,t) = β1(t) / β0(t), which shows that there is little distortion of α0(s) at negative times close to the index event if the risk of an occurrence of B is largely independent of whether or not A has occurred. Otherwise, one must face the possibility that there can be considerable systematic distortion in the estimates of α0(s) produced for times before the occurrence of the (conditioning) index event on the B process, and one should probably avoid making such estimates. In particular, if β1(t) < β0(t), the computations will underestimate the intensity α0(s) at times just before t.

Let us pursue the idea of non-differential intensities for B, which means that βi(t) is independent of i, that is, βi(t) = β(t) for the same function β(t) for both values of i. In this case p11(s,t) = exp (−∫_t^s β(u)du) and p0j(s,t) = p0j(s,t) exp (−∫_t^s β(u)du) for j = 0,1 where p0j(s,t) is the value that one will get for p0j(s,t) when β(t) → 0. (Thus p0j(s,t) is what is sometimes called a partial probability; see Hoem 1969). Therefore, exp (−∫_t^s β(u)du) β(t) is a common factor in the numerator and denominator of the distortion factor, which means that it cancels and leaves just 1 in the numerator. In the denominator, p00(s,t) = exp (−∫_t^s α0(u)du) and p01(s,t) = ∫_t^s p00(s,u)α0(u)du = 1 − exp (−∫_t^s α0(u)du), so the whole denominator is also identically equal to 1. [In fact, we must have p00(s,t) + p01(s,t) = 1 because from State 0 there is nowhere else to go than to one of the States 0 and 1 between times s and t when β0(t) = β1(t) = 0.] Thus, φA(s,t) = 1 and there is no distortion when β0(t) = β1(t), that is, when there is no differentiality in the B process. [In statistical terminology going back to a seminal paper by Schweder (1970), B is then said to be locally independent of A. Note that when B is locally independent, the non-distortion result holds and we get no estimation bias before the B event. Establishing whether B is locally independent is normally likely to be a project in itself, however.]

These arguments carry over to a situation where the intensities depend on a (possibly multidimensional) covariate, say X, which will most probably include individual age (Andersson 2004; Andersson and Scott 2005; Kulu 2006; Kulu and Milewski 2007; Kulu and Vikat 2007; Nedoluzhko and Andersson 2007; Milewski 2008; and many others). In this case, the functions that define the distortion factor will also depend on X and so will the distortion itself, which we can now call φA(s,t,X). If the (X-dependent) intensities β0(t,X) and β1(t,X) are coinciding functions of X and t (the local-independence case), then φA(s,t,X) = 1 and there is no estimation bias. If the β intensities differ from each other, then there may be a noticeable estimation bias. This covers the case of observed heterogeneity, in that X is taken to represent observed characteristics of the individuals. Alternatively or additionally, the intensities may be subject to unobserved heterogeneity that varies from individual to individual, and that is structured in a manner which makes individuals who have higher childbearing intensities also have lower migration intensities and conversely lets individuals with higher migration intensities also have lower fertility. This structure may be quite plausible and is a different way of obtaining the effect we have sought to cover so far by our specification of the relationships between the basic intensities. (For a particularly clear specification of this nature, see Kulu 2006.) For the analyst confronted with data collected conditionally on the occurrence of a migratory event it is a problem, however, that (as far as we know) all methods that can be used to reveal the existence and effect of unobserved heterogeneity require data both for individuals who migrate and for those who do not. If data are not available for migrants and non-migrants alike, the analyst has no way of determining whether the relations between the fertility observed before and after migration is caused by features of reality or by the method of analysis. This unresolved feature (produced by the presence of heterogeneity) will appear in similar form in all the examples used above to illuminate the problem, and instead of repeating what we have said in each instance we have disregarded both observed and unobserved heterogeneity in the rest of our discussion in this paper.

As we have noted before, the accounts above contain very simple specifications of the behavior in question. Another way of making them a bit more realistic is to let the post-B intensity for Process A depend on the duration d since the occurrence of B and thus be a function α1(s,d). Similarly, one can let the post-A intensity for B be some function β1(t,d) that depends on the duration d since the occurrence of A, as in work by Kulu (2005) and elsewhere. Duration-dependent intensities make formulas such as those for distortion factors considerably more complex, but the principles remain the same. In fact, estimates of the intensities at times on the positive axis of process time are unbiased while estimates of the intensities at negative process times are biased except in special cases. In particular, A-process estimates are unbiased when the B process is locally independent. In practice, however, it is probably at least as hard to establish such local independence as it is to study the two interacting processes A and B, each in its own right.
Intensities. For a particularly clear specification of this nature, see Kulu 2006. For the analyst confronted with data collected conditionally on the occurrence of a migratory event, it is a problem, however, that all methods that can be used to reveal the existence and effect of unobserved heterogeneity require data both for individuals who migrate and for those who do not. If data are not available for migrants and non-migrants alike, the analyst has no way of determining whether the relations between the fertility observed before and after migration is caused by features of reality or by the method of analysis. This unresolved feature (produced by the presence of heterogeneity) will appear in similar form in all the examples used above to illuminate the problem, and instead of repeating what we have said in each instance we have disregarded both observed and unobserved heterogeneity in the rest of our discussion in this paper.

As we have noted before, the accounts above contain very simple specifications of the behaviour in question. Another way of making them a bit more realistic is to let the post-B intensity for Process A depend on the duration since the occurrence of B and thus be a function α1(s,d). Similarly, one can let the post-A intensity for B be some function β1(t,d) that depends on the duration since the occurrence of A, as in work by Kulu (2005) and elsewhere. Duration-dependent intensities make formulas such as those for distortion factors considerably more complex, but the principles remain the same. In fact, estimates of the intensities at times on the positive axis of process time are unbiased while estimates of the intensities at negative process times are biased except in special cases. In particular, A-process estimates are unbiased when the B process is locally independent. In practice, however, it is probably at least as hard to establish such local independence as it is to study the two interacting processes A and B, each in its own right.

Conclusions

In the analysis of two interacting behaviours, it is always best to study all transition intensities involved and to use data that make this possible. In general, this will allow the analyst to compare pre-index-time with post-index-time behaviour without the risk of estimation biases. Otherwise, conditioning on one behaviour in the analysis of another will normally introduce distortions in the analysis unless the process on which the analyst conditions (Process B) has non-differential transition intensities with respect to the behaviour in focus (Process A) [i.e., unless B is locally independent of A]. In practice, the conditional before-and-after type of analysis that is frequently carried out is likely to produce a distortion in the pre-B-event intensity estimate for Process A in most cases and should therefore be avoided. In particular, it is good practice to refrain from trying to study fertility before migration on the basis of data confined to in-migrants or to study any behaviour A before event B only on the basis of those who experience B. Normally the analyst has little control over estimation biases in periods before the conditioning event and cannot safely distinguish between behavioural intentions and these biases. Intentions are best documented (if it can be done at all) from direct observation. If complete data are available, the unbiased procedure is to analyse all transition intensities. Studying each process conditionally on event occurrence in the other (as is sometimes done) cannot be recommended as an alternative to analyzing all intensities in their own right, because a conditional both-ways analysis will simply suffer from estimation biases in both directions.